# Configuração do Gitleaks para detectar secrets e credenciais expostas
# Documentação: https://github.com/gitleaks/gitleaks

title = "Gitleaks Configuration - POC Security Tools"

# Paths a serem ignorados (não escanear)
[allowlist]
paths = [
  '''node_modules/''',
  '''package-lock.json''',
  '''dist/''',
  '''build/''',
]

# Regras de detecção de secrets
[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)api[_-]?key[_\s]*[:=][_\s]*['"]?[a-z0-9_\-]{20,}['"]?'''

[[rules]]
id = "database-connection-string"
description = "Database Connection String with credentials"
regex = '''(?i)(mongodb|postgresql|mysql|redis)://[^:\s]+:[^@\s]+@'''

[[rules]]
id = "generic-password"
description = "Generic Password"
regex = '''(?i)password[_\s]*[:=][_\s]*['"][^'"]{8,}['"]'''

[[rules]]
id = "jwt-secret"
description = "JWT Secret"  
regex = '''(?i)jwt[_-]?secret[_\s]*[:=][_\s]*['"][^'"]{20,}['"]'''

[[rules]]
id = "private-key"
description = "Private Key"
regex = '''-----BEGIN\s+(RSA\s+)?PRIVATE\s+KEY-----'''

[[rules]]
id = "bearer-token"
description = "Bearer Token"
regex = '''Bearer\s+[a-zA-Z0-9\-_\.=]{20,}'''

